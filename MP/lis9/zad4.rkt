#lang racket

(define morse-chars
    '((#\a . ".-") (#\b . "-...") (#\c . "-.-.") (#\d . "-..") (#\e . ".")
      (#\f . "..-.") (#\g . "--.") (#\h . "....") (#\i . "..") (#\j . ".---")
      (#\k . "-.-") (#\l . ".-..") (#\m . "--") (#\n . "-.") (#\o . "---")
      (#\p . ".--.") (#\q . "--.-") (#\r . ".-.") (#\s . "...") (#\t . "-")
      (#\u . "..-") (#\v . "...-") (#\w . ".--") (#\x . "-..-") (#\y . "-.--")
      (#\z . "--..") (#\1 . ".----") (#\2 . "..---") (#\3 . "...--")
      (#\4 . "....-") (#\5 . ".....") (#\6 . "-....") (#\7 . "--...")
      (#\8 . "---..") (#\9 . "----.") (#\0 . "-----") (#\space . " ")
      (#\. . ".-.-.-") (#\_ . "..--.-") (#\, "--..--") (#\? "..--..") (#\! "-.-.--")))

(define (lowerlist s)
  (string->list (string-downcase s)))

(define (ctomors c)
  (cdr (assoc c  morse-chars)))

(define (stomorslist s)
  (map ctomors (lowerlist s)))

(define (morse-code s)
  (string-join (stomorslist s)))