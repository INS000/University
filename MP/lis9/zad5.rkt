#lang racket

(define morse-chars '((".-" . #\a)("-..." . #\b)("-.-." . #\c)("-.." . #\d)("." . #\e)
                        ("..-." . #\f)("--." . #\g)("...." . #\h)(".." . #\i)(".---" . #\j)
                        ("-.-" . #\k)(".-.." . #\l)("--" . #\m)("-." . #\n)("---" . #\o)
                        (".--." . #\p)("--.-" . #\q)(".-." . #\r)("..." . #\s)("-" . #\t)
                        ("..-" . #\u)("...-" . #\v)(".--" . #\w)("-..-" . #\x)("-.--" . #\y)
                        ("--.." . #\z)(".----" . #\1)("..---" . #\2)("...--" . #\3)("....-" . #\4)
                        ("....." . #\5)("-...." . #\6)("--..." . #\7)("---.." . #\8)("----." . #\9)
                        ("-----" . #\0)("" . #\space)(".-.-.-" . #\.) ("..--.-" . #\_) ("--..--" . #\,)("..--.." . #\?)("-.-.--" . #\!)))


(define (morstoc m)
  (cdr (assoc m  morse-chars)))

(define (stomorslist s)
  (map morstoc (string-split s " ")))

(define (morse-decode s)
  (list->string (stomorslist s)))

(morse-decode "-- .--.  ..--- ----- ..--- ..---")